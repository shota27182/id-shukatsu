<div class="container">
    <div class="back-to-present">
        <a href="javascript:history.back()" class="profile-mypage-link"><イベント結果に戻る</a>
    </div>
    <div class="company-middle">
        <div class="company-middle-left">
            <div class="event-top-wrapper">
              <div class="event-img">
                  <%= image_tag @event.img.to_s, class:"event-top-img" %>
              </div>
              <div class="event-head">
                  <div class="event-head-right">
                 <% Company.joins(:events).where(events:{id:[@event.id]}).each do |i| %>
                 <%=image_tag i.icon.to_s %>
                 <% end %>
                 </div>
                 <div class="event-head-title">
                     <p><%=@event.name%></p>
                 </div>
              </div>
            </div>
            <div class="company-event-information quick-entry sm-version">
                <div class="company-event-head">簡単エントリー</div>
                <%= form_with url: new_event_entry_path(@event), method: :get, local: true do |f|%>
                <%= f.collection_radio_buttons(:event_schedule , @event_schedule, :id, :id ) do |b| %>
                <div class="company-event-quick">
                    <div class="company-event-quick-left">
                        <%= b.radio_button %>
                        <% if EventSchedule.find(b.text).holding_day.present? %>
                            <%= EventSchedule.find(b.text).holding_day.strftime("%m/%d") %>
                        <% end %>
                    </div>
                    <div class="company-event-quick-right">
                        <% if EventSchedule.find(b.text).start_time.present? && EventSchedule.find(b.text).end_time.present? %>
                            <p><%= EventSchedule.find(b.text).start_time.strftime('%H:%M') %>~<%= EventSchedule.find(b.text).start_time.strftime('%H:%M') %></p>
                        <% end %>
                        <% if EventSchedule.find(b.text).address.present? %>
                            <p><%= EventSchedule.find(b.text).address %></p>
                        <% end %>
                    </div>
                </div>
                <% end %>
                <%= f.submit 'エントリーする',class: "form-submit", id: "button1" %>
                <% end %>
            </div>
            <div class="company-introduction">
                <div class="company-introduction-title">イベント詳細</div>
                <div class="recruit-form">
                    <div class="recruit-form-left">
                        <p>概要</p>
                    </div>
                    <div class="recruit-form-right">
                        <%= @event.introduction.html_safe  %>
                    </div>
                </div>
                <% if @event.point.present? %>
                    <div class="recruit-form">
                        <div class="recruit-form-left">
                            <p>本ガイダンスのポイント</p>
                        </div>
                        <div class="recruit-form-right">
                            <%= @event.point.html_safe %>
                        </div>
                    </div>
                <% end %>
                <% if @event.flow.present? %>
                    <div class="recruit-form">
                        <div class="recruit-form-left">
                            <p>当日のプログラム</p>
                        </div>
                        <div class="recruit-form-right">
                            <%= @event.flow.html_safe %>
                        </div>
                    </div>
                <% end %>
                <% @event.event_profiles.each do |a| %>
                <div class="recruit-form">
                    <div class="recruit-form-left">
                        <p><%= a.title %></p>
                    </div>
                    <div class="recruit-form-right">
                        <%= simple_format(a.content) %>
                    </div>
                </div>
                <% end %>
                <div class="recruit-form">
                    <div class="recruit-form-left">
                        <p>エントリー</p>
                    </div>
                    <div class="recruit-form-right">
                      <% @event_schedule.each.with_index(1) do |event_schedule, index|%>
                          <% if index == 1 %>
                           <div class="entry-area-first">
                               <div class="event-title">
                                   <h2><%=event_schedule.title %></h2>
                                   <% if event_schedule.holding_day.present? || ( event_schedule.start_time.present? && event_schedule.end_time.present?) %>
                                       <img src="/assets/clock.svg">
                                    <% end %>
                                   <% if event_schedule.holding_day.present? %>
                                       <p class="entry-date"><%= event_schedule.holding_day.strftime("%m/%d") %><%= %w((日) (月) (火) (水) (木) (金) (土))[event_schedule.holding_day.wday] %></p>
                                    <% end %>
                                    <% if event_schedule.start_time.present? && event_schedule.end_time.present? %>
                                       <p class="entry-time"><%= event_schedule.start_time.strftime('%H:%M') %> - <%= event_schedule.end_time.strftime('%H:%M') %></p>
                                    <% end %>
                                    <% if event_schedule.address.present? && event_schedule.place.present? %>
                                       <img src="/assets/location.svg">
                                       <p class="entry-location"><%= event_schedule.address + event_schedule.place%></p>
                                    <% end %>
                                </div>
                                <div class="event-entry">
                                    <% if event_schedule.deadline.present? %>
                                        <p>締切 <%= event_schedule.deadline.strftime("%m月%d日") %><%= %w((日) (月) (火) (水) (木) (金) (土))[event_schedule.deadline.wday] %></p>
                                    <% end %>
                                    <div class="entry-button">
                                        <% if logged_in? && current_user.events.where(id: params[:id]).includes(:user_events).where(user_events: {activate: true}).present? %>
                                            <p>エントリー済み</p>
                                        <% else %>
                                            <%= link_to 'エントリーする',new_event_entry_path(@event,event_schedule:event_schedule.id)%>
                                        <% end %>
                                    </div>
                                </div>
                            </div>
                           <% else %>
                            <div class="entry-area">
                               <div class="event-title">
                                   <h2><%=event_schedule.title %></h2>
                                   <% if event_schedule.holding_day.present? || ( event_schedule.start_time.present? && event_schedule.end_time.present?) %>
                                       <img src="/assets/clock.svg">
                                    <% end %>
                                   <% if event_schedule.holding_day.present? %>
                                       <p class="entry-date"><%= event_schedule.holding_day.strftime("%m/%d") %><%= %w((日) (月) (火) (水) (木) (金) (土))[event_schedule.holding_day.wday] %></p>
                                    <% end %>
                                    <% if event_schedule.start_time.present? && event_schedule.end_time.present? %>
                                       <p class="entry-time"><%= event_schedule.start_time.strftime('%H:%M') %> - <%= event_schedule.end_time.strftime('%H:%M') %></p>
                                    <% end %>
                                    <% if event_schedule.address.present? && event_schedule.place.present? %>
                                       <img src="/assets/location.svg">
                                       <p class="entry-location"><%= event_schedule.address + event_schedule.place%></p>
                                    <% end %>
                                </div>
                                <div class="event-entry">
                                    <% if event_schedule.deadline.present? %>
                                        <p>締切 <%= event_schedule.deadline.strftime("%m月%d日") %><%= %w((日) (月) (火) (水) (木) (金) (土))[event_schedule.deadline.wday] %></p>
                                    <% end %>
                                    <div class="entry-button">
                                        <% if logged_in? && current_user.events.where(id: params[:id]).includes(:user_events).where(user_events: {activate: true}).present? %>
                                            <p>エントリー済み</p>
                                        <% else %>
                                            <%= link_to 'エントリーする',new_event_entry_path(@event,event_schedule:event_schedule.id)%>
                                        <% end %>
                                    </div>
                                </div>
                            </div>
                           <% end %>
                      <% end %>
                    </div>
                </div>
            </div>
            <% if Company.joins(:events).where(events:{id:[@event.id]}).present? && @company.events.count >= 2 %>
            <div class="company-introduction">
                <div class="company-introduction-title other-introduction"><%= @company.name %>の他の募集情報</div>
                <% if (@company.events.where(category: 1).count >= 2 && @event.category == 1) || (@company.events.where(category: 1).count >= 1 && @event.category != 1) %>
                    <div class="other-event-title">本選考</div>
                    <div class="other-event-content">
                    <% @company.events.where(category: 1).each do |i| %>
                        <% Event.find_by(id: i.id).event_schedules.each do |a| %>
                            <div class="entry-area go-to-other-event">
                                <a href="/events/<%= i.id %>"></a>
                               <div class="event-title">
                                   <h2><%=i.name %></h2>
                                   <img src="/assets/clock.svg">
                                   <% if a.holding_day.present? %>
                                       <p class="entry-date"><%= a.holding_day.strftime("%m/%d") %><%= %w((日) (月) (火) (水) (木) (金) (土))[a.holding_day.wday] %></p>
                                    <% end %>
                                    <% if a.start_time.present? && a.end_time.present? %>
                                       <p class="entry-time"><%= a.start_time.strftime('%H:%M') %> - <%= a.end_time.strftime('%H:%M') %></p>
                                    <% end %>
                                    <% if a.address.present? && a.place.present? %>
                                       <img src="/assets/location.svg">
                                       <p class="entry-location"><%= a.address + a.place%></p>
                                    <% end %>
                                </div>
                                <% if a.deadline.present? %>
                                    <div class="event-entry">
                                        <p>締切 <%= a.deadline.strftime("%m月%d日") %><%= %w((日) (月) (火) (水) (木) (金) (土))[a.deadline.wday] %></p>
                                    </div>
                                <% end %>
                            </div>
                        <% end %>
                    <% end %>
                    </div>
                <% end %>
                <% if (@company.events.where(category: 2).count >= 2 && @event.category == 2) || (@company.events.where(category: 2).count >= 1 && @event.category != 2) %>
                    <div class="other-event-title">インターンシップ・ジョブ</div>
                    <div class="other-event-content">
                    <% @company.events.where(category: 2).each do |i| %>
                        <% Event.find_by(id: i.id).event_schedules.each do |a| %>
                            <div class="entry-area go-to-other-event">
                                <a href="/events/<%= i.id %>"></a>
                               <div class="event-title">
                                   <h2><%=i.name %></h2>
                                   <img src="/assets/clock.svg">
                                   <% if a.holding_day.present? %>
                                       <p class="entry-date"><%= a.holding_day.strftime("%m/%d") %><%= %w((日) (月) (火) (水) (木) (金) (土))[a.holding_day.wday] %></p>
                                    <% end %>
                                    <% if a.start_time.present? && a.end_time.present? %>
                                       <p class="entry-time"><%= a.start_time.strftime('%H:%M') %> - <%= a.end_time.strftime('%H:%M') %></p>
                                    <% end %>
                                    <% if a.address.present? && a.place.present? %>
                                       <img src="/assets/location.svg">
                                       <p class="entry-location"><%= a.address + a.place%></p>
                                    <% end %>
                                </div>
                                <% if a.deadline.present? %>
                                    <div class="event-entry">
                                        <p>締切 <%= a.deadline.strftime("%m月%d日") %><%= %w((日) (月) (火) (水) (木) (金) (土))[a.deadline.wday] %></p>
                                    </div>
                                <% end %>
                            </div>
                        <% end %>
                    <% end %>
                    </div>
                <% end %>
                <% if (@company.events.where(category: 3).count >= 2 && @event.category == 3) || (@company.events.where(category: 3).count >= 1 && @event.category != 3) %>
                    <div class="other-event-title">説明会・企業セミナー</div>
                    <div class="other-event-content">
                    <% @company.events.where(category: 3).each do |i| %>
                        <% Event.find_by(id: i.id).event_schedules.each do |a| %>
                            <div class="entry-area go-to-other-event">
                                <a href="/events/<%= i.id %>"></a>
                               <div class="event-title">
                                   <h2><%=i.name %></h2>
                                   <img src="/assets/clock.svg">
                                   <% if a.holding_day.present? %>
                                       <p class="entry-date"><%= a.holding_day.strftime("%m/%d") %><%= %w((日) (月) (火) (水) (木) (金) (土))[a.holding_day.wday] %></p>
                                    <% end %>
                                    <% if a.start_time.present? && a.end_time.present? %>
                                       <p class="entry-time"><%= a.start_time.strftime('%H:%M') %> - <%= a.end_time.strftime('%H:%M') %></p>
                                    <% end %>
                                    <% if a.address.present? && a.place.present? %>
                                       <img src="/assets/location.svg">
                                       <p class="entry-location"><%= a.address + a.place%></p>
                                    <% end %>
                                </div>
                                <% if a.deadline.present? %>
                                    <div class="event-entry">
                                        <p>締切 <%= a.deadline.strftime("%m月%d日") %><%= %w((日) (月) (火) (水) (木) (金) (土))[a.deadline.wday] %></p>
                                    </div>
                                <% end %>
                            </div>
                        <% end %>
                    <% end %>
                    </div>
                <% end %>
            </div>
            <% end %>
        </div>
        <div class="company-middle-right">
            <div class="company-event-information quick-entry pc-version">
                <div class="company-event-head">簡単エントリー</div>
                <%= form_with url: new_event_entry_path(@event), method: :get, local: true do |f|%>
                    <%= f.collection_radio_buttons(:event_schedule , @event_schedule, :id, :id , { checked: @event_schedule.first.id } ) do |b| %>
                        <div class="company-event-quick">
                            <div class="company-event-quick-left">
                                <%= b.radio_button %>
                                <% if EventSchedule.find(b.text).holding_day.present? %>
                                    <%= EventSchedule.find(b.text).holding_day.strftime("%m/%d") %>
                                <% end %>
                            </div>
                            <div class="company-event-quick-right">
                                <% if EventSchedule.find(b.text).start_time.present? && EventSchedule.find(b.text).end_time.present? %>
                                    <p><%= EventSchedule.find(b.text).start_time.strftime('%H:%M') %>~<%= EventSchedule.find(b.text).start_time.strftime('%H:%M') %></p>
                                <% end %>
                                <% if EventSchedule.find(b.text).address.present? %>
                                    <p><%= EventSchedule.find(b.text).address %></p>
                                <% end %>
                            </div>
                        </div>
                    <% end %>
                    <% if logged_in? && current_user.events.where(id: params[:id]).includes(:user_events).where(user_events: {activate: true}).present? %>
                        <p>エントリー済み</p>
                    <% else %>
                        <%= f.submit 'エントリーする',class: "form-submit", id: "button1" %>
                    <% end %>
                <% end %>
            </div>
        </div>
    </div>
</div>

<script>
$(function() {
	$("#button1").click(function() {

		const str1 = $('input:radio[name="event_schedule"]:checked').val();
		
	});
	
	$('.go-to-other-event').click(function(){
        location.href=$(this).find('a').attr('href');
    });
	
});
</script>