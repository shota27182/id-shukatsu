/*!
 * froala_editor v3.2.0 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2020 Froala Labs
 */
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?a(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],a):a(e.FroalaEditor)}(this,function(e){"use strict";if(e=e&&e.hasOwnProperty("default")?e["default"]:e,Object.assign(e.DEFAULTS,{imageManagerLoadURL:"https://i.froala.com/load-files",imageManagerLoadMethod:"get",imageManagerLoadParams:{},imageManagerPreloader:null,imageManagerDeleteURL:"",imageManagerDeleteMethod:"post",imageManagerDeleteParams:{},imageManagerPageSize:12,imageManagerScrollOffset:20,imageManagerToggleTags:!0}),e.PLUGINS.imageManager=function(a){function t(){var e=E(window).outerWidth();return e<768?2:e<1200?3:4}function r(){L.empty();for(var e=0;e<T;e++)L.append('<div class="fr-list-column"></div>')}function n(){if(P<y.length&&(L.outerHeight()<=w.outerHeight()+a.opts.imageManagerScrollOffset||w.scrollTop()+a.opts.imageManagerScrollOffset>L.outerHeight()-w.outerHeight())){I++;for(var e=a.opts.imageManagerPageSize*(I-1);e<Math.min(y.length,a.opts.imageManagerPageSize*I);e++)i(y[e])}}function i(e){var t=new Image,r=E(document.createElement("div")).attr("class","fr-image-container fr-empty fr-image-"+S++).attr("data-loading",a.language.translate("Loading")+"..").attr("data-deleting",a.language.translate("Deleting")+"..");l(!1),t.onload=function(){r.height(Math.floor(r.width()/t.width*t.height));var i=E(document.createElement("img"));if(e.thumb)i.attr("src",e.thumb);else{if(f(q,e),!e.url)return f(_,e),!1;i.attr("src",e.url)}if(e.url&&i.attr("data-url",e.url),e.tag)if(b.find(".fr-modal-more.fr-not-available").removeClass("fr-not-available"),b.find(".fr-modal-tags").show(),0<=e.tag.indexOf(",")){for(var o=e.tag.split(","),d=0;d<o.length;d++)o[d]=o[d].trim(),0===D.find('a[title="'.concat(o[d],'"]')).length&&D.append('<a role="button" title="'.concat(o[d],'">').concat(o[d],"</a>"));i.attr("data-tag",o.join())}else 0===D.find('a[title="'.concat(e.tag.trim(),'"]')).length&&D.append('<a role="button" title="'.concat(e.tag.trim(),'">').concat(e.tag.trim(),"</a>")),i.attr("data-tag",e.tag.trim());for(var m in e.name&&i.attr("alt",e.name),e)e.hasOwnProperty(m)&&"thumb"!==m&&"url"!==m&&"tag"!==m&&i.attr("data-".concat(m),e[m]);r.append(i).append(E(a.icon.create("imageManagerDelete")).addClass("fr-delete-img").attr("title",a.language.translate("Delete"))).append(E(a.icon.create("imageManagerInsert")).addClass("fr-insert-img").attr("title",a.language.translate("Insert"))),D.find(".fr-selected-tag").each(function(e,a){v(i,a.text)||r.hide()}),i.on("load",function(){r.removeClass("fr-empty"),r.height("auto"),P++,g(s(parseInt(i.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1)),l(!1),P%a.opts.imageManagerPageSize==0&&n()}),a.events.trigger("imageManager.imageLoaded",[i])},t.onerror=function(){P++,r.remove(),g(s(parseInt(r.attr("class").match(/fr-image-(\d+)/)[1],10)+1)),f(O,e),P%a.opts.imageManagerPageSize==0&&n()},t.src=e.thumb||e.url,o().append(r)}function o(){var e,a;return L.find(".fr-list-column").each(function(t,r){var n=E(r);0===t?(a=n.outerHeight(),e=n):n.outerHeight()<a&&(a=n.outerHeight(),e=n)}),e}function s(e){e===undefined&&(e=0);for(var a=[],t=S-1;e<=t;t--){var r=L.find(".fr-image-".concat(t));r.length&&(a.push(r),E(document.createElement("div")).attr("id","fr-image-hidden-container").append(r),L.find(".fr-image-".concat(t)).remove())}return a}function g(e){for(var a=e.length-1;0<=a;a--)o().append(e[a])}function l(e){if(e===undefined&&(e=!0),!M.isVisible())return!0;var i=t();if(i!==T){T=i;var o=s();r(),g(o)}a.modals.resize(x),e&&n()}function d(e){for(var a,t=e[0].attributes,r=t.length,n={};r--;)t[r]&&0===(a=t[r].name).indexOf("data-")&&"url"!==(a=a.slice(5))&&"tag"!==a&&(n[a]=t[r].value);return n}function m(e){var t=E(e.currentTarget).siblings("img"),r=M.data("instance")||a,n=M.data("current-image");if(a.modals.hide(x),r.image.showProgressBar(),n)n.data("fr-old-src",n.attr("src")),n.trigger("click");else{r.events.focus(!0),r.selection.restore();var i=r.position.getBoundingRect(),o=i.left+i.width/2+E(a.doc).scrollLeft(),s=i.top+i.height+E(a.doc).scrollTop();r.popups.setContainer("image.insert",a.$sc),r.popups.show("image.insert",o,s)}r.image.insert(t.data("url"),!1,d(t),n)}function c(e){var t=E(e.currentTarget).siblings("img"),r=a.language.translate("Are you sure? Image will be deleted.");confirm(r)&&(a.opts.imageManagerDeleteURL?!1!==a.events.trigger("imageManager.beforeDeleteImage",[t])&&(t.parent().addClass("fr-image-deleting"),E(this).ajax({method:a.opts.imageManagerDeleteMethod,url:a.opts.imageManagerDeleteURL,data:Object.assign(Object.assign({src:t.attr("src")},d(t)),a.opts.imageManagerDeleteParams),crossDomain:a.opts.requestWithCORS,withCredentials:a.opts.requestWithCredentials,headers:a.opts.requestHeaders,done:function(e){a.events.trigger("imageManager.imageDeleted",[e]);var r=s(parseInt(t.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);t.parent().remove(),g(r),M.find("#fr-modal-tags > a").each(function(){0===M.find('#fr-image-list [data-tag*="'.concat(E(this).text(),'"]')).length&&E(this).removeClass("fr-selected-tag").hide()}),p(),l(!0)},fail:function(e){f(k,e.response||e.responseText)}})):f(j))}function f(e,t){10<=e&&e<20?C.hide():20<=e&&e<30&&E(".fr-image-deleting").removeClass("fr-image-deleting"),a.events.trigger("imageManager.error",[{code:e,message:z[e]},t])}function u(){var e=b.find(".fr-modal-head-line").outerHeight(),a=D.outerHeight();b.toggleClass("fr-show-tags"),b.hasClass("fr-show-tags")?(b.css("height",e+a),w.css("marginTop",e+a),D.find("a").css("opacity",1)):(b.css("height",e),w.css("marginTop",e),D.find("a").css("opacity",0))}function p(){var e=D.find(".fr-selected-tag");0<e.length?(L.find("img").parents().show(),e.each(function(e,a){L.find("img").each(function(e,t){var r=E(t);v(r,a.text)||r.parent().hide()})})):L.find("img").parents().show(),g(s()),n()}function h(e){e.preventDefault();var t=E(e.currentTarget);t.toggleClass("fr-selected-tag"),a.opts.imageManagerToggleTags&&t.siblings("a").removeClass("fr-selected-tag"),p()}function v(e,a){for(var t=(e.attr("data-tag")||"").split(","),r=0;r<t.length;r++)if(t[r]===a)return!0;return!1}var M,b,w,C,L,D,y,I,P,S,T,E=a.$,x="image_manager",O=10,R=11,U=12,H=13,q=14,_=15,k=21,j=22,z={};return z[O]="Image cannot be loaded from the passed link.",z[R]="Error during load images request.",z[U]="Missing imageManagerLoadURL option.",z[H]="Parsing load response failed.",z[q]="Missing image thumb.",z[_]="Missing image URL.",z[k]="Error during delete image request.",z[j]="Missing imageManagerDeleteURL option.",{require:["image"],_init:function(){if(!a.$wp&&"IMG"!==a.el.tagName)return!1},show:function(){if(!M){var i,o='<button class="fr-command fr-btn fr-modal-more fr-not-available" id="fr-modal-more-'.concat(a.sid,'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24""><path d="').concat(e.SVG.tags,'"/></svg></button><h4 data-text="true">').concat(a.language.translate("Manage Images"),'</h4></div>\n      <div class="fr-modal-tags" id="fr-modal-tags">');i=a.opts.imageManagerPreloader?'<img class="fr-preloader" id="fr-preloader" alt="'.concat(a.language.translate("Loading"),'.." src="').concat(a.opts.imageManagerPreloader,'" style="display: none;">'):'<span class="fr-preloader" id="fr-preloader" style="display: none;">'.concat(a.language.translate("Loading"),"</span>"),i+='<div class="fr-image-list" id="fr-image-list"></div>';var s=a.modals.create(x,o,i);M=s.$modal,b=s.$head,w=s.$body}M.data("current-image",a.image.get()),a.modals.show(x),C||(C=M.find("#fr-preloader"),L=M.find("#fr-image-list"),D=M.find("#fr-modal-tags"),T=t(),r(),b.css("height",b.find(".fr-modal-head-line").outerHeight()),a.events.$on(E(a.o_win),"resize",function(){l(!!y)}),a.events.bindClick(L,".fr-insert-img",m),a.events.bindClick(L,".fr-delete-img",c),a.helpers.isMobile()&&(a.events.bindClick(L,"div.fr-image-container",function(e){M.find(".fr-mobile-selected").removeClass("fr-mobile-selected"),E(e.currentTarget).addClass("fr-mobile-selected")}),M.on(a._mousedown,function(){M.find(".fr-mobile-selected").removeClass("fr-mobile-selected")})),M.on(a._mousedown+" "+a._mouseup,function(e){e.stopPropagation()}),M.on(a._mousedown,"*",function(){a.events.disableBlur()}),w.on("scroll",n),a.events.bindClick(M,"button#fr-modal-more-".concat(a.sid),u),a.events.bindClick(D,"a",h)),function(){C.show(),L.find(".fr-list-column").empty(),a.opts.imageManagerLoadURL?E(this).ajax({url:a.opts.imageManagerLoadURL,method:a.opts.imageManagerLoadMethod,data:a.opts.imageManagerLoadParams,crossDomain:a.opts.requestWithCORS,withCredentials:a.opts.requestWithCredentials,headers:a.opts.requestHeaders,done:function(e,t,r){a.events.trigger("imageManager.imagesLoaded",[e]),function(e,a){try{L.find(".fr-list-column").empty(),S=P=I=0,y=JSON.parse(e),n()}catch(r){f(H,a)}}(e,r.response),C.hide()},fail:function(e){f(R,e.response||e.responseText)}}):f(U)}()},hide:function(){a.modals.hide(x)}}},!e.PLUGINS.image)throw new Error("Image manager plugin requires image plugin.");e.DEFAULTS.imageInsertButtons.push("imageManager"),e.RegisterCommand("imageManager",{title:"Browse",undo:!1,focus:!1,modal:!0,callback:function(){this.imageManager.show()},plugin:"imageManager"}),e.DefineIcon("imageManager",{NAME:"folder",SVG_KEY:"imageManager"}),e.DefineIcon("imageManagerInsert",{NAME:"plus",SVG_KEY:"add"}),e.DefineIcon("imageManagerDelete",{NAME:"trash",SVG_KEY:"remove"})});